# 飞腾派硬件平台的驱动程序开发

## 文档说明

* **飞腾派软件编程手册**，手册中包含详细的飞腾派板子上的各类外设的设备地址空间，及寄存器描述；
  
* "飞腾派裸机SDK指导手册"，含有各类驱动的示例，如i2c, gpio, timer, serial, sd卡 等。

* "飞腾派OS用户使用开发手册"，飞腾派Linux系统的使用，系统的安装启动等，以及Linux内核的 编译工具链下载， Linux内核配置，编译；Buildroot编译等；

* "飞腾派软件开发手册", 飞腾派Linux的各类驱动编程接口及测试，包括QT编程，还有Linux上硬件驱动如: GPIO,PWM,UART,I2C,SPI,CAN,USB,以太网, 蓝牙, WiFi;

* "Phytium Pi GPIO口介绍", 飞腾派板子上的GPIO口的多种Function列举。

* "飞腾派v3原理图", 板子上的各个硬件设备的电路连接原理图，如USB, MiniPCIE, Wifi&BT, eMMC&SD等设备。

* GPIO-controller-pl061, ARM GPIO控制器`pl061`的寄存器描述手册， Qemu有对该设备的模拟。

* 6300esb-io-controller-hub-datasheet， `Intel 6300ESB` 看门狗设备的寄存器描述手册，Qemu有对该看门狗设备的模拟。


## 硬件设备驱动开发

**硬件设备驱动开发教程演示文稿**

请见：https://github.com/elliott10/dev-hw-driver/tree/main/docs/

### 硬件控制类驱动

GPIO引脚的寄存器设置；
引脚复用；
根据设备树配置；
‌Pinctrl（Pin Control）是Linux内核中用于统一管理引脚配置的子系统。

复位控制寄存器设置；

PWM驱动，波形生成与电机控制。
PWM是Pulse-Width Modulation的简称，中文译作脉冲宽度调制。作为一种调制技术，PWM的原理是通过调整周期性波形的高电平时间宽度，从而改变有效信号的占空比，实现对设备的供电控制。PWM技术的常见应用领域包括屏幕背光亮度调节、电机转速控制和风扇转速控制等。


### 时钟类驱动

* 通用计时器Timer
  
    Linux的时钟子系统由CCF（common clock framework）。

* 看门狗驱动


* NOC时钟寄存器设置；

    SoC：System on Chip，中文称为片上系统。在 ASIC 设计的早期，由于制造工艺和性能等的约束，大部分芯片都单纯地实现某个特定功能，如处理器内核、总线、内存控制器、蓝牙等都由各自独立的芯片分别实现，处理器之间的通信也以多颗芯片互连的方式实现。随着制造工艺的提升，以及设计能力的增强，单颗 ASIC 的功能越来越全面和强大，在一颗芯片内完全可以实现诸如处理器内核、总线、内存控制器、蓝牙等所有的功能。这样，就出现了在一颗芯片里集成了大量的处理器内核、总线、控制器等 IP，而处理器内核数量也由曾经的单核增大到多核、众核。一颗 SoC 可以实现以前多颗 ASIC 构成的系统。

    NoC：Network on Chip，中文称之为片上网络。随着 SoC 技术的发展，芯片内部的 IP 核越来越多，有可能在一颗芯片中集成了数以百记的处理器内核（包括同构处理器内核和异构处理器内核）、数以千计控制器 IP 核等等，那么这种情况下 IP 核之间的互联就成为 SoC 性能一个重要组成部分。而 NoC 技术的诞生就是为了能够让 IP 核之间的通信能够实现高效、高吞吐量、低功耗的目的。因此 NoC 技术主要研究对象就是各种互连方法、互连结构，以及 IP 核互联网络中路由算法。

    因此， 在嵌入式系统中，硬件NOC时钟（Network on Chip Clock）是用于驱动片上网络（NoC, Network on Chip）的时钟信号。NoC是现代复杂SoC（System on Chip）中用于管理多个核心、IP模块和内存之间通信的关键基础设施，而NOC时钟则是确保其高效运行的基础。

### 外设协议类驱动

* UART串口通信驱动

* I2C驱动，I2C时序解析与传感器。
  
    I2C，也叫IIC. 很常用的一个串行通信接口，总线支持设备之间的短距离通信，用于处理器和一些外围设备之间数据传输，它只需要两根信号线来就能完成数据传输。常用于连接各种外设、传感器等器件）。

* SPI驱动开发，SPI通信与传感器。

    SPI是一种高速、高效率的串行接口技术。通常由一个主模块和一个或多个从模块组成，主模块选择一个从模块进行同步通信，从而完成数据的交换，被广泛应用于 ADC、LCD 等设备与 MCU 之间。